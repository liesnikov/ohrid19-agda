<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Jesper Cockx">
  <meta name="dcterms.date" content="2019-09-03">
  <title>Correct-by-construction programming in Agda</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//css/reveal.css">
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//css/theme/black.css" id="theme">
  <link rel="stylesheet" href="white.css"/>
  <link rel="stylesheet" href="Agda.css"/>
  <link rel="stylesheet" href="patchTheme.css"/>
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//css/print/pdf.css' : 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Correct-by-construction programming in Agda</h1>
  <p class="subtitle">Lecture 4: (Non-)termination</p>
  <p class="author">Jesper Cockx</p>
  <p class="date">3 September 2019</p>
</section>

<section id="section" class="slide level2">
<h2></h2>
<p>"I’ll save the world…</p>
<p>tomorrow."</p>
<p>– unknown</p>
</section>
<section><section id="totality-checking" class="title-slide slide level1"><h1>Totality checking</h1></section><section id="partial-functions-in-type-theory" class="slide level2">
<h2>Partial functions in type theory</h2>
<!--
<pre class="Agda"><a id="352" class="Symbol">{-#</a> <a id="356" class="Keyword">OPTIONS</a> <a id="364" class="Pragma">--guardedness</a> <a id="378" class="Symbol">#-}</a>
<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="Library.html" class="Module">Library</a>
</pre>-->
<p>What happens if we have a partial function in Agda?</p>
<ul>
<li>Theory would become inconsistent!</li>
</ul>
<pre class="unchecked"><code>absurd : ⊥
absurd = absurd</code></pre>
<ul>
<li>Typechecker would crash or loop!</li>
</ul>
<pre class="unchecked"><code>f : ℕ → ℕ
f zero = 42

test : Vec ℕ (f 1)
test = []</code></pre>
<p>⇒ Partial functions must be ruled out!</p>
</section><section id="checking-totality" class="slide level2">
<h2>Checking totality</h2>
<ol type="1">
<li><strong>Completeness</strong> of pattern matching</li>
<li><strong>Structural recursion</strong> of recursive functions</li>
<li><strong>Strict positivity</strong> of inductive datatypes</li>
<li><strong>Consistency</strong> of universe levels</li>
</ol>
<p>2-4 together ensure normalization of well-typed terms</p>
</section><section id="primitive-recursion" class="slide level2">
<h2>Primitive recursion</h2>
<pre class="Agda"><a id="plus"></a><a id="972" href="slides4.html#972" class="Function">plus</a> <a id="977" class="Symbol">:</a> <a id="979" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="981" class="Symbol">→</a> <a id="983" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="985" class="Symbol">→</a> <a id="987" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="989" href="slides4.html#972" class="Function">plus</a> <a id="994" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1002" href="slides4.html#1002" class="Bound">m</a> <a id="1004" class="Symbol">=</a> <a id="1006" href="slides4.html#1002" class="Bound">m</a>
<a id="1008" href="slides4.html#972" class="Function">plus</a> <a id="1013" class="Symbol">(</a><a id="1014" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1018" href="slides4.html#1018" class="Bound">n</a><a id="1019" class="Symbol">)</a> <a id="1021" href="slides4.html#1021" class="Bound">m</a> <a id="1023" class="Symbol">=</a> <a id="1025" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1029" class="Symbol">(</a><a id="1030" href="slides4.html#972" class="Function">plus</a> <a id="1035" href="slides4.html#1018" class="Bound">n</a> <a id="1037" href="slides4.html#1021" class="Bound">m</a><a id="1038" class="Symbol">)</a>

<a id="natEq"></a><a id="1041" href="slides4.html#1041" class="Function">natEq</a> <a id="1047" class="Symbol">:</a> <a id="1049" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1051" class="Symbol">→</a> <a id="1053" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1055" class="Symbol">→</a> <a id="1057" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1062" href="slides4.html#1041" class="Function">natEq</a> <a id="1068" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1076" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1084" class="Symbol">=</a> <a id="1086" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
<a id="1091" href="slides4.html#1041" class="Function">natEq</a> <a id="1097" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1105" class="Symbol">(</a><a id="1106" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1110" href="slides4.html#1110" class="Bound">m</a><a id="1111" class="Symbol">)</a> <a id="1113" class="Symbol">=</a> <a id="1115" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1121" href="slides4.html#1041" class="Function">natEq</a> <a id="1127" class="Symbol">(</a><a id="1128" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1132" href="slides4.html#1132" class="Bound">n</a><a id="1133" class="Symbol">)</a> <a id="1135" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1143" class="Symbol">=</a> <a id="1145" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1151" href="slides4.html#1041" class="Function">natEq</a> <a id="1157" class="Symbol">(</a><a id="1158" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1162" href="slides4.html#1162" class="Bound">n</a><a id="1163" class="Symbol">)</a> <a id="1165" class="Symbol">(</a><a id="1166" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1170" href="slides4.html#1170" class="Bound">m</a><a id="1171" class="Symbol">)</a> <a id="1173" class="Symbol">=</a> <a id="1175" href="slides4.html#1041" class="Function">natEq</a> <a id="1181" href="slides4.html#1162" class="Bound">n</a> <a id="1183" href="slides4.html#1170" class="Bound">m</a>
</pre>
</section><section id="structural-recursion" class="slide level2">
<h2>Structural recursion</h2>
<pre class="Agda"><a id="fib"></a><a id="1219" href="slides4.html#1219" class="Function">fib</a> <a id="1223" class="Symbol">:</a> <a id="1225" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1227" class="Symbol">→</a> <a id="1229" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1231" href="slides4.html#1219" class="Function">fib</a> <a id="1235" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>          <a id="1249" class="Symbol">=</a> <a id="1251" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="1256" href="slides4.html#1219" class="Function">fib</a> <a id="1260" class="Symbol">(</a><a id="1261" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1265" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1269" class="Symbol">)</a>    <a id="1274" class="Symbol">=</a> <a id="1276" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1280" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="1285" href="slides4.html#1219" class="Function">fib</a> <a id="1289" class="Symbol">(</a><a id="1290" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1294" class="Symbol">(</a><a id="1295" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1299" href="slides4.html#1299" class="Bound">n</a><a id="1300" class="Symbol">))</a> <a id="1303" class="Symbol">=</a> <a id="1305" href="slides4.html#972" class="Function">plus</a> <a id="1310" class="Symbol">(</a><a id="1311" href="slides4.html#1219" class="Function">fib</a> <a id="1315" href="slides4.html#1299" class="Bound">n</a><a id="1316" class="Symbol">)</a> <a id="1318" class="Symbol">(</a><a id="1319" href="slides4.html#1219" class="Function">fib</a> <a id="1323" class="Symbol">(</a><a id="1324" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1328" href="slides4.html#1299" class="Bound">n</a><a id="1329" class="Symbol">))</a>
</pre>
<pre class="Agda"><a id="ack"></a><a id="1341" href="slides4.html#1341" class="Function">ack</a> <a id="1345" class="Symbol">:</a> <a id="1347" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1349" class="Symbol">→</a> <a id="1351" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1353" class="Symbol">→</a> <a id="1355" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1357" href="slides4.html#1341" class="Function">ack</a> <a id="1361" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1369" href="slides4.html#1369" class="Bound">m</a>       <a id="1377" class="Symbol">=</a> <a id="1379" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1383" href="slides4.html#1369" class="Bound">m</a>
<a id="1385" href="slides4.html#1341" class="Function">ack</a> <a id="1389" class="Symbol">(</a><a id="1390" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1394" href="slides4.html#1394" class="Bound">n</a><a id="1395" class="Symbol">)</a> <a id="1397" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1405" class="Symbol">=</a> <a id="1407" href="slides4.html#1341" class="Function">ack</a> <a id="1411" href="slides4.html#1394" class="Bound">n</a> <a id="1413" class="Symbol">(</a><a id="1414" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1418" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1422" class="Symbol">)</a>
<a id="1424" href="slides4.html#1341" class="Function">ack</a> <a id="1428" class="Symbol">(</a><a id="1429" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1433" href="slides4.html#1433" class="Bound">n</a><a id="1434" class="Symbol">)</a> <a id="1436" class="Symbol">(</a><a id="1437" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1441" href="slides4.html#1441" class="Bound">m</a><a id="1442" class="Symbol">)</a> <a id="1444" class="Symbol">=</a> <a id="1446" href="slides4.html#1341" class="Function">ack</a> <a id="1450" href="slides4.html#1433" class="Bound">n</a> <a id="1452" class="Symbol">(</a><a id="1453" href="slides4.html#1341" class="Function">ack</a> <a id="1457" class="Symbol">(</a><a id="1458" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1462" href="slides4.html#1433" class="Bound">n</a><a id="1463" class="Symbol">)</a> <a id="1465" href="slides4.html#1441" class="Bound">m</a><a id="1466" class="Symbol">)</a>
</pre>
</section></section>
<section><section id="coinduction" class="title-slide slide level1"><h1>Coinduction</h1></section><section id="a-frequently-asked-question" class="slide level2">
<h2>A frequently asked question</h2>
<p>“If all functions in Agda are total, doesn’t that mean Agda is not Turing-complete?”</p>
<div class="fragment">
<p><em>Answer</em>: <strong>NO!</strong> Agda just forces you to be <em>honest</em> about when a function is non-terminating.</p>
</div>
</section><section id="coinduction-in-agda" class="slide level2">
<h2>Coinduction in Agda</h2>
<p>A <strong>coinductive type</strong> = a type with possibly infinitely deep values.</p>
<!--
<pre class="Agda"><a id="1818" class="Keyword">module</a> <a id="Coinduction"></a><a id="1825" href="slides4.html#1825" class="Module">Coinduction</a> <a id="1837" class="Keyword">where</a>
  <a id="1845" class="Keyword">module</a> <a id="Coinduction.GuardedStream"></a><a id="1852" href="slides4.html#1852" class="Module">GuardedStream</a> <a id="1866" class="Keyword">where</a>
</pre>-->
<pre class="Agda">    <a id="1893" class="Keyword">record</a> <a id="Coinduction.GuardedStream.Stream"></a><a id="1900" href="slides4.html#1900" class="Record">Stream</a> <a id="1907" class="Symbol">(</a><a id="1908" href="slides4.html#1908" class="Bound">A</a> <a id="1910" class="Symbol">:</a> <a id="1912" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1915" class="Symbol">)</a> <a id="1917" class="Symbol">:</a> <a id="1919" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1923" class="Keyword">where</a>
      <a id="1935" class="Keyword">coinductive</a>
      <a id="1953" class="Keyword">field</a>
        <a id="Coinduction.GuardedStream.Stream.head"></a><a id="1967" href="slides4.html#1967" class="Field">head</a> <a id="1972" class="Symbol">:</a> <a id="1974" href="slides4.html#1908" class="Bound">A</a>
        <a id="Coinduction.GuardedStream.Stream.tail"></a><a id="1984" href="slides4.html#1984" class="Field">tail</a> <a id="1989" class="Symbol">:</a> <a id="1991" href="slides4.html#1900" class="Record">Stream</a> <a id="1998" href="slides4.html#1908" class="Bound">A</a>
    <a id="2004" class="Keyword">open</a> <a id="2009" href="slides4.html#1900" class="Module">Stream</a>

    <a id="Coinduction.GuardedStream.repeat"></a><a id="2021" href="slides4.html#2021" class="Function">repeat</a> <a id="2028" class="Symbol">:</a> <a id="2030" class="Symbol">{</a><a id="2031" href="slides4.html#2031" class="Bound">A</a> <a id="2033" class="Symbol">:</a> <a id="2035" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2038" class="Symbol">}</a> <a id="2040" class="Symbol">→</a> <a id="2042" href="slides4.html#2031" class="Bound">A</a> <a id="2044" class="Symbol">→</a> <a id="2046" href="slides4.html#1900" class="Record">Stream</a> <a id="2053" href="slides4.html#2031" class="Bound">A</a>
    <a id="2059" href="slides4.html#1967" class="Field">head</a> <a id="2064" class="Symbol">(</a><a id="2065" href="slides4.html#2021" class="Function">repeat</a> <a id="2072" href="slides4.html#2072" class="Bound">x</a><a id="2073" class="Symbol">)</a> <a id="2075" class="Symbol">=</a> <a id="2077" href="slides4.html#2072" class="Bound">x</a>
    <a id="2083" href="slides4.html#1984" class="Field">tail</a> <a id="2088" class="Symbol">(</a><a id="2089" href="slides4.html#2021" class="Function">repeat</a> <a id="2096" href="slides4.html#2096" class="Bound">x</a><a id="2097" class="Symbol">)</a> <a id="2099" class="Symbol">=</a> <a id="2101" href="slides4.html#2021" class="Function">repeat</a> <a id="2108" href="slides4.html#2096" class="Bound">x</a>
</pre>
</section><section id="mixing-induction-and-coinduction-12" class="slide level2">
<h2>Mixing induction and coinduction (1/2)</h2>
<pre class="Agda">  <a id="2166" class="Keyword">mutual</a>
    <a id="2177" class="Keyword">record</a> <a id="Coinduction.Coℕ′"></a><a id="2184" href="slides4.html#2184" class="Record">Coℕ′</a> <a id="2189" class="Symbol">:</a> <a id="2191" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2195" class="Keyword">where</a>
      <a id="2207" class="Keyword">coinductive</a>
      <a id="2225" class="Keyword">field</a>
        <a id="Coinduction.Coℕ′.force"></a><a id="2239" href="slides4.html#2239" class="Field">force</a> <a id="2245" class="Symbol">:</a> <a id="2247" href="slides4.html#2261" class="Datatype">Coℕ</a>

    <a id="2256" class="Keyword">data</a> <a id="Coinduction.Coℕ"></a><a id="2261" href="slides4.html#2261" class="Datatype">Coℕ</a> <a id="2265" class="Symbol">:</a> <a id="2267" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2271" class="Keyword">where</a>
      <a id="Coinduction.Coℕ.zero"></a><a id="2283" href="slides4.html#2283" class="InductiveConstructor">zero</a> <a id="2288" class="Symbol">:</a> <a id="2290" href="slides4.html#2261" class="Datatype">Coℕ</a>
      <a id="Coinduction.Coℕ.suc"></a><a id="2300" href="slides4.html#2300" class="InductiveConstructor">suc</a>  <a id="2305" class="Symbol">:</a> <a id="2307" href="slides4.html#2184" class="Record">Coℕ′</a> <a id="2312" class="Symbol">→</a> <a id="2314" href="slides4.html#2261" class="Datatype">Coℕ</a>
  <a id="2320" class="Keyword">open</a> <a id="2325" href="slides4.html#2184" class="Module">Coℕ′</a> <a id="2330" class="Keyword">public</a>
</pre>
</section><section id="mixing-induction-and-coinduction-22" class="slide level2">
<h2>Mixing induction and coinduction (2/2)</h2>
<pre class="Agda">  <a id="Coinduction.fromℕ"></a><a id="2391" href="slides4.html#2391" class="Function">fromℕ</a> <a id="2397" class="Symbol">:</a> <a id="2399" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2401" class="Symbol">→</a> <a id="2403" href="slides4.html#2261" class="Datatype">Coℕ</a>
  <a id="Coinduction.fromℕ′"></a><a id="2409" href="slides4.html#2409" class="Function">fromℕ′</a> <a id="2416" class="Symbol">:</a> <a id="2418" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2420" class="Symbol">→</a> <a id="2422" href="slides4.html#2184" class="Record">Coℕ′</a>

  <a id="2430" href="slides4.html#2391" class="Function">fromℕ</a> <a id="2436" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="2441" class="Symbol">=</a> <a id="2443" href="slides4.html#2283" class="InductiveConstructor">zero</a>
  <a id="2450" href="slides4.html#2391" class="Function">fromℕ</a> <a id="2456" class="Symbol">(</a><a id="2457" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2461" href="slides4.html#2461" class="Bound">x</a><a id="2462" class="Symbol">)</a> <a id="2464" class="Symbol">=</a> <a id="2466" href="slides4.html#2300" class="InductiveConstructor">suc</a> <a id="2470" class="Symbol">(</a><a id="2471" href="slides4.html#2409" class="Function">fromℕ′</a> <a id="2478" href="slides4.html#2461" class="Bound">x</a><a id="2479" class="Symbol">)</a>

  <a id="2484" href="slides4.html#2409" class="Function">fromℕ′</a> <a id="2491" href="slides4.html#2491" class="Bound">x</a> <a id="2493" class="Symbol">.</a><a id="2494" href="slides4.html#2239" class="Field">force</a> <a id="2500" class="Symbol">=</a> <a id="2502" href="slides4.html#2391" class="Function">fromℕ</a> <a id="2508" href="slides4.html#2491" class="Bound">x</a>

  <a id="Coinduction.infty"></a><a id="2513" href="slides4.html#2513" class="Function">infty</a>  <a id="2520" class="Symbol">:</a> <a id="2522" href="slides4.html#2261" class="Datatype">Coℕ</a>
  <a id="Coinduction.infty′"></a><a id="2528" href="slides4.html#2528" class="Function">infty′</a> <a id="2535" class="Symbol">:</a> <a id="2537" href="slides4.html#2184" class="Record">Coℕ′</a>

  <a id="2545" href="slides4.html#2513" class="Function">infty</a> <a id="2551" class="Symbol">=</a> <a id="2553" href="slides4.html#2300" class="InductiveConstructor">suc</a> <a id="2557" href="slides4.html#2528" class="Function">infty′</a>
  <a id="2566" href="slides4.html#2528" class="Function">infty′</a> <a id="2573" class="Symbol">.</a><a id="2574" href="slides4.html#2239" class="Field">force</a> <a id="2580" class="Symbol">=</a> <a id="2582" href="slides4.html#2513" class="Function">infty</a>
</pre>
</section><section id="dealing-with-infinite-computations" class="slide level2">
<h2>Dealing with infinite computations</h2>
<p>Remember: all Agda functions must be <strong>total</strong></p>
<p>One way to work around this is by adding ‘fuel’:</p>
<!--
<pre class="Agda">  <a id="2741" class="Keyword">postulate</a>
    <a id="Coinduction.⋯"></a><a id="2755" href="slides4.html#2755" class="Postulate">⋯</a> <a id="2757" class="Symbol">:</a> <a id="2759" class="Symbol">{</a><a id="2760" href="slides4.html#2760" class="Bound">A</a> <a id="2762" class="Symbol">:</a> <a id="2764" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2767" class="Symbol">}</a> <a id="2769" class="Symbol">→</a> <a id="2771" href="slides4.html#2760" class="Bound">A</a>
    <a id="Coinduction.Term"></a><a id="2777" href="slides4.html#2777" class="Postulate">Term</a> <a id="Coinduction.Val"></a><a id="2782" href="slides4.html#2782" class="Postulate">Val</a> <a id="2786" class="Symbol">:</a> <a id="2788" href="Agda.Primitive.html#326" class="Primitive">Set</a>
</pre>-->
<pre class="Agda">  <a id="Coinduction.step"></a><a id="2807" href="slides4.html#2807" class="Function">step</a> <a id="2812" class="Symbol">:</a> <a id="2814" href="slides4.html#2777" class="Postulate">Term</a> <a id="2819" class="Symbol">→</a> <a id="2821" href="slides4.html#2777" class="Postulate">Term</a> <a id="2826" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="2828" href="slides4.html#2782" class="Postulate">Val</a>
  <a id="2834" href="slides4.html#2807" class="Function">step</a> <a id="2839" class="Symbol">=</a> <a id="2841" href="slides4.html#2755" class="Postulate">⋯</a>

  <a id="Coinduction.eval"></a><a id="2846" href="slides4.html#2846" class="Function">eval</a> <a id="2851" class="Symbol">:</a> <a id="2853" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2855" class="Symbol">→</a> <a id="2857" href="slides4.html#2777" class="Postulate">Term</a> <a id="2862" class="Symbol">→</a> <a id="2864" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2870" href="slides4.html#2782" class="Postulate">Val</a>
  <a id="2876" href="slides4.html#2846" class="Function">eval</a> <a id="2881" class="Symbol">(</a><a id="2882" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2886" href="slides4.html#2886" class="Bound">n</a><a id="2887" class="Symbol">)</a> <a id="2889" href="slides4.html#2889" class="Bound">t</a> <a id="2891" class="Symbol">=</a> <a id="2893" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="2898" class="Symbol">(</a><a id="2899" href="slides4.html#2807" class="Function">step</a> <a id="2904" href="slides4.html#2889" class="Bound">t</a><a id="2905" class="Symbol">)</a> <a id="2907" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="2910" class="Symbol">λ</a> <a id="2912" class="Keyword">where</a>
    <a id="2922" class="Symbol">(</a><a id="2923" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="2928" href="slides4.html#2928" class="Bound">t&#39;</a><a id="2930" class="Symbol">)</a> <a id="2932" class="Symbol">→</a> <a id="2934" href="slides4.html#2846" class="Function">eval</a> <a id="2939" href="slides4.html#2886" class="Bound">n</a> <a id="2941" href="slides4.html#2889" class="Bound">t</a>
    <a id="2947" class="Symbol">(</a><a id="2948" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="2953" href="slides4.html#2953" class="Bound">v</a><a id="2954" class="Symbol">)</a>  <a id="2957" class="Symbol">→</a> <a id="2959" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2964" href="slides4.html#2953" class="Bound">v</a>
  <a id="2968" href="slides4.html#2846" class="Function">eval</a> <a id="2973" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="2978" href="slides4.html#2978" class="Bound">t</a> <a id="2980" class="Symbol">=</a> <a id="2982" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
</pre>
<p>Can we do better?</p>
</section><section id="going-carbon-free-with-the-delay-monad" class="slide level2">
<h2>Going carbon-free with the <code>Delay</code> monad</h2>
<p>A value of type <code>Delay A</code> is</p>
<ul>
<li>either a value of type <code>A</code> produced <strong>now</strong></li>
<li>or a computation of type <code>Delay A</code> producing a value <strong>later</strong></li>
</ul>
<p>The <code>Delay</code> monad captures the effect of <em>non-termination</em></p>
</section><section id="the-delay-monad-definition" class="slide level2">
<h2>The Delay monad: definition</h2>
<pre class="Agda">  <a id="3304" class="Keyword">mutual</a>
    <a id="3315" class="Keyword">record</a> <a id="Coinduction.Delay"></a><a id="3322" href="slides4.html#3322" class="Record">Delay</a> <a id="3328" class="Symbol">(</a><a id="3329" href="slides4.html#3329" class="Bound">A</a> <a id="3331" class="Symbol">:</a> <a id="3333" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3336" class="Symbol">)</a> <a id="3338" class="Symbol">:</a> <a id="3340" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3344" class="Keyword">where</a>
      <a id="3356" class="Keyword">coinductive</a>
      <a id="3374" class="Keyword">field</a> <a id="Coinduction.Delay.force"></a><a id="3380" href="slides4.html#3380" class="Field">force</a> <a id="3386" class="Symbol">:</a> <a id="3388" href="slides4.html#3407" class="Datatype">Delay&#39;</a> <a id="3395" href="slides4.html#3329" class="Bound">A</a>

    <a id="3402" class="Keyword">data</a> <a id="Coinduction.Delay&#39;"></a><a id="3407" href="slides4.html#3407" class="Datatype">Delay&#39;</a> <a id="3414" class="Symbol">(</a><a id="3415" href="slides4.html#3415" class="Bound">A</a> <a id="3417" class="Symbol">:</a> <a id="3419" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3422" class="Symbol">)</a> <a id="3424" class="Symbol">:</a> <a id="3426" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3430" class="Keyword">where</a>
      <a id="Coinduction.Delay&#39;.now"></a><a id="3442" href="slides4.html#3442" class="InductiveConstructor">now</a>   <a id="3448" class="Symbol">:</a> <a id="3450" href="slides4.html#3415" class="Bound">A</a>       <a id="3458" class="Symbol">→</a> <a id="3460" href="slides4.html#3407" class="Datatype">Delay&#39;</a> <a id="3467" href="slides4.html#3415" class="Bound">A</a>
      <a id="Coinduction.Delay&#39;.later"></a><a id="3475" href="slides4.html#3475" class="InductiveConstructor">later</a> <a id="3481" class="Symbol">:</a> <a id="3483" href="slides4.html#3322" class="Record">Delay</a> <a id="3489" href="slides4.html#3415" class="Bound">A</a> <a id="3491" class="Symbol">→</a> <a id="3493" href="slides4.html#3407" class="Datatype">Delay&#39;</a> <a id="3500" href="slides4.html#3415" class="Bound">A</a>

  <a id="3505" class="Keyword">open</a> <a id="3510" href="slides4.html#3322" class="Module">Delay</a> <a id="3516" class="Keyword">public</a>

  <a id="Coinduction.never"></a><a id="3526" href="slides4.html#3526" class="Function">never</a> <a id="3532" class="Symbol">:</a> <a id="3534" class="Symbol">{</a><a id="3535" href="slides4.html#3535" class="Bound">A</a> <a id="3537" class="Symbol">:</a> <a id="3539" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3542" class="Symbol">}</a> <a id="3544" class="Symbol">→</a> <a id="3546" href="slides4.html#3322" class="Record">Delay</a> <a id="3552" href="slides4.html#3535" class="Bound">A</a>
  <a id="3556" href="slides4.html#3380" class="Field">force</a> <a id="3562" href="slides4.html#3526" class="Function">never</a> <a id="3568" class="Symbol">=</a> <a id="3570" href="slides4.html#3475" class="InductiveConstructor">later</a> <a id="3576" href="slides4.html#3526" class="Function">never</a>
</pre>
</section><section id="unrolling-a-delayed-value" class="slide level2">
<h2>Unrolling a <code>Delay</code>ed value</h2>
<pre class="Agda">  <a id="Coinduction.unroll"></a><a id="3625" href="slides4.html#3625" class="Function">unroll</a> <a id="3632" class="Symbol">:</a> <a id="3634" class="Symbol">{</a><a id="3635" href="slides4.html#3635" class="Bound">A</a> <a id="3637" class="Symbol">:</a> <a id="3639" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3642" class="Symbol">}</a> <a id="3644" class="Symbol">→</a> <a id="3646" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3648" class="Symbol">→</a> <a id="3650" href="slides4.html#3322" class="Record">Delay</a> <a id="3656" href="slides4.html#3635" class="Bound">A</a> <a id="3658" class="Symbol">→</a> <a id="3660" href="slides4.html#3635" class="Bound">A</a> <a id="3662" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="3664" href="slides4.html#3322" class="Record">Delay</a> <a id="3670" href="slides4.html#3635" class="Bound">A</a>
  <a id="3674" href="slides4.html#3625" class="Function">unroll</a> <a id="3681" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="3689" href="slides4.html#3689" class="Bound">x</a> <a id="3691" class="Symbol">=</a> <a id="3693" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="3698" href="slides4.html#3689" class="Bound">x</a>
  <a id="3702" href="slides4.html#3625" class="Function">unroll</a> <a id="3709" class="Symbol">(</a><a id="3710" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3714" href="slides4.html#3714" class="Bound">n</a><a id="3715" class="Symbol">)</a> <a id="3717" href="slides4.html#3717" class="Bound">x</a> <a id="3719" class="Symbol">=</a> <a id="3721" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="3726" class="Symbol">(</a><a id="3727" href="slides4.html#3380" class="Field">force</a> <a id="3733" href="slides4.html#3717" class="Bound">x</a><a id="3734" class="Symbol">)</a> <a id="3736" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="3739" class="Symbol">λ</a> <a id="3741" class="Keyword">where</a>
    <a id="3751" class="Symbol">(</a><a id="3752" href="slides4.html#3442" class="InductiveConstructor">now</a> <a id="3756" href="slides4.html#3756" class="Bound">v</a>  <a id="3759" class="Symbol">)</a> <a id="3761" class="Symbol">→</a> <a id="3763" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="3768" href="slides4.html#3756" class="Bound">v</a>
    <a id="3774" class="Symbol">(</a><a id="3775" href="slides4.html#3475" class="InductiveConstructor">later</a> <a id="3781" href="slides4.html#3781" class="Bound">d</a><a id="3782" class="Symbol">)</a> <a id="3784" class="Symbol">→</a> <a id="3786" href="slides4.html#3625" class="Function">unroll</a> <a id="3793" href="slides4.html#3714" class="Bound">n</a> <a id="3795" href="slides4.html#3781" class="Bound">d</a>
</pre>
</section></section>
<section><section id="sized-types" class="title-slide slide level1"><h1>Sized types</h1></section><section id="using-sizes-to-prove-termination" class="slide level2">
<h2>Using sizes to prove termination</h2>
<p>Totality requirement: coinductive definitions should be <strong>productive</strong>: computing each observation should be terminating.</p>
<p>To ensure this, Agda checks that corecursive calls are <strong>guarded by constructors</strong>, but this is often quite limiting.</p>
<p>A more flexible and modular approach is to use <strong>sized types</strong>.</p>
</section><section id="the-type-size" class="slide level2">
<h2>The type <code>Size</code></h2>
<p><code>Size</code> ≃ abstract version of the natural numbers extended with <code>∞</code></p>
<p>For each <code>i : Size</code>, we have a type <code>Size&lt; i</code> of sizes <strong>smaller than <code>i</code></strong>.</p>
<p><strong>Note</strong>: pattern matching on <code>Size</code> is not allowed!</p>
</section><section id="the-sized-delay-monad" class="slide level2">
<h2>The sized delay monad</h2>
<!--
<pre class="Agda"><a id="4420" class="Keyword">module</a> <a id="SizedTypes"></a><a id="4427" href="slides4.html#4427" class="Module">SizedTypes</a> <a id="4438" class="Keyword">where</a>
  <a id="4446" class="Keyword">open</a> <a id="4451" class="Keyword">import</a> <a id="4458" href="Size.html" class="Module">Size</a>
</pre>-->
<pre class="Agda">  <a id="4482" class="Keyword">mutual</a>
    <a id="4493" class="Keyword">record</a> <a id="SizedTypes.Delay"></a><a id="4500" href="slides4.html#4500" class="Record">Delay</a> <a id="4506" class="Symbol">(</a><a id="4507" href="slides4.html#4507" class="Bound">i</a> <a id="4509" class="Symbol">:</a> <a id="4511" href="Agda.Builtin.Size.html#202" class="Postulate">Size</a><a id="4515" class="Symbol">)</a> <a id="4517" class="Symbol">(</a><a id="4518" href="slides4.html#4518" class="Bound">A</a> <a id="4520" class="Symbol">:</a> <a id="4522" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4525" class="Symbol">)</a> <a id="4527" class="Symbol">:</a> <a id="4529" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4533" class="Keyword">where</a>
      <a id="4545" class="Keyword">coinductive</a>
      <a id="4563" class="Keyword">constructor</a> <a id="SizedTypes.delay"></a><a id="4575" href="slides4.html#4575" class="CoinductiveConstructor">delay</a>
      <a id="4587" class="Keyword">field</a>
        <a id="SizedTypes.Delay.force"></a><a id="4601" href="slides4.html#4601" class="Field">force</a> <a id="4607" class="Symbol">:</a> <a id="4609" class="Symbol">{</a><a id="4610" href="slides4.html#4610" class="Bound">j</a> <a id="4612" class="Symbol">:</a> <a id="4614" href="Agda.Builtin.Size.html#236" class="Postulate Operator">Size&lt;</a> <a id="4620" href="slides4.html#4507" class="Bound">i</a><a id="4621" class="Symbol">}</a> <a id="4623" class="Symbol">→</a> <a id="4625" href="slides4.html#4646" class="Datatype">Delay&#39;</a> <a id="4632" href="slides4.html#4610" class="Bound">j</a> <a id="4634" href="slides4.html#4518" class="Bound">A</a>

    <a id="4641" class="Keyword">data</a> <a id="SizedTypes.Delay&#39;"></a><a id="4646" href="slides4.html#4646" class="Datatype">Delay&#39;</a> <a id="4653" class="Symbol">(</a><a id="4654" href="slides4.html#4654" class="Bound">i</a> <a id="4656" class="Symbol">:</a> <a id="4658" href="Agda.Builtin.Size.html#202" class="Postulate">Size</a><a id="4662" class="Symbol">)</a> <a id="4664" class="Symbol">(</a><a id="4665" href="slides4.html#4665" class="Bound">A</a> <a id="4667" class="Symbol">:</a> <a id="4669" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4672" class="Symbol">)</a> <a id="4674" class="Symbol">:</a> <a id="4676" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4680" class="Keyword">where</a>
      <a id="SizedTypes.Delay&#39;.return&#39;"></a><a id="4692" href="slides4.html#4692" class="InductiveConstructor">return&#39;</a> <a id="4700" class="Symbol">:</a> <a id="4702" href="slides4.html#4665" class="Bound">A</a>         <a id="4712" class="Symbol">→</a> <a id="4714" href="slides4.html#4646" class="Datatype">Delay&#39;</a> <a id="4721" href="slides4.html#4654" class="Bound">i</a> <a id="4723" href="slides4.html#4665" class="Bound">A</a>
      <a id="SizedTypes.Delay&#39;.later&#39;"></a><a id="4731" href="slides4.html#4731" class="InductiveConstructor">later&#39;</a>  <a id="4739" class="Symbol">:</a> <a id="4741" href="slides4.html#4500" class="Record">Delay</a> <a id="4747" href="slides4.html#4654" class="Bound">i</a> <a id="4749" href="slides4.html#4665" class="Bound">A</a> <a id="4751" class="Symbol">→</a> <a id="4753" href="slides4.html#4646" class="Datatype">Delay&#39;</a> <a id="4760" href="slides4.html#4654" class="Bound">i</a> <a id="4762" href="slides4.html#4665" class="Bound">A</a>
</pre>
<p><code>i</code> ≃ how many more steps are we allowed to observe.</p>
<p><code>Delay ∞ A</code> is the type of computations that can take <em>any</em> number of steps.</p>
</section><section id="interpreting-well-typed-while-programs" class="slide level2">
<h2>Interpreting well-typed WHILE programs</h2>
<p>WHILE statements can have two effects:</p>
<ul>
<li>Modify the environment ⇒ <code>State</code> monad</li>
<li>Go into a loop ⇒ <code>Delay</code> monad</li>
</ul>
<p>We combine both effects in the <code>Exec</code> monad.</p>
</section><section id="the-exec-monad" class="slide level2">
<h2>The <code>Exec</code> monad</h2>
<!--
<pre class="Agda">  <a id="5152" class="Keyword">open</a> <a id="5157" class="Keyword">import</a> <a id="5164" href="Library.html" class="Module">Library</a>
  <a id="5174" class="Keyword">postulate</a>
    <a id="SizedTypes.⋯"></a><a id="5188" href="slides4.html#5188" class="Postulate">⋯</a> <a id="5190" class="Symbol">:</a> <a id="5192" class="Symbol">{</a><a id="5193" href="slides4.html#5193" class="Bound">A</a> <a id="5195" class="Symbol">:</a> <a id="5197" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5200" class="Symbol">}</a> <a id="5202" class="Symbol">→</a> <a id="5204" href="slides4.html#5193" class="Bound">A</a>
    <a id="SizedTypes.Cxt"></a><a id="5210" href="slides4.html#5210" class="Postulate">Cxt</a> <a id="5214" class="Symbol">:</a> <a id="5216" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="SizedTypes.Stm"></a><a id="5224" href="slides4.html#5224" class="Postulate">Stm</a> <a id="5228" class="Symbol">:</a> <a id="5230" href="slides4.html#5210" class="Postulate">Cxt</a> <a id="5234" class="Symbol">→</a> <a id="5236" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="SizedTypes.Env"></a><a id="5244" href="slides4.html#5244" class="Postulate">Env</a> <a id="5248" class="Symbol">:</a> <a id="5250" href="slides4.html#5210" class="Postulate">Cxt</a> <a id="5254" class="Symbol">→</a> <a id="5256" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="SizedTypes.Program"></a><a id="5264" href="slides4.html#5264" class="Postulate">Program</a> <a id="5272" class="Symbol">:</a> <a id="5274" href="Agda.Primitive.html#326" class="Primitive">Set</a>
</pre>-->
<pre class="Agda">  <a id="5297" class="Keyword">record</a> <a id="SizedTypes.Exec"></a><a id="5304" href="slides4.html#5304" class="Record">Exec</a> <a id="5309" class="Symbol">{</a><a id="5310" href="slides4.html#5310" class="Bound">Γ</a> <a id="5312" class="Symbol">:</a> <a id="5314" href="slides4.html#5210" class="Postulate">Cxt</a><a id="5317" class="Symbol">}</a> <a id="5319" class="Symbol">(</a><a id="5320" href="slides4.html#5320" class="Bound">i</a> <a id="5322" class="Symbol">:</a> <a id="5324" href="Agda.Builtin.Size.html#202" class="Postulate">Size</a><a id="5328" class="Symbol">)</a> <a id="5330" class="Symbol">(</a><a id="5331" href="slides4.html#5331" class="Bound">A</a> <a id="5333" class="Symbol">:</a> <a id="5335" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5338" class="Symbol">)</a> <a id="5340" class="Symbol">:</a> <a id="5342" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="5346" class="Keyword">where</a>
    <a id="5356" class="Keyword">field</a>
      <a id="SizedTypes.Exec.runExec"></a><a id="5368" href="slides4.html#5368" class="Field">runExec</a> <a id="5376" class="Symbol">:</a> <a id="5378" class="Symbol">(</a><a id="5379" href="slides4.html#5379" class="Bound">ρ</a> <a id="5381" class="Symbol">:</a> <a id="5383" href="slides4.html#5244" class="Postulate">Env</a> <a id="5387" href="slides4.html#5310" class="Bound">Γ</a><a id="5388" class="Symbol">)</a> <a id="5390" class="Symbol">→</a> <a id="5392" href="slides4.html#4500" class="Record">Delay</a> <a id="5398" href="slides4.html#5320" class="Bound">i</a> <a id="5400" class="Symbol">(</a><a id="5401" href="slides4.html#5331" class="Bound">A</a> <a id="5403" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5405" href="slides4.html#5244" class="Postulate">Env</a> <a id="5409" href="slides4.html#5310" class="Bound">Γ</a><a id="5410" class="Symbol">)</a>
  <a id="5414" class="Keyword">open</a> <a id="5419" href="slides4.html#5304" class="Module">Exec</a> <a id="5424" class="Keyword">public</a>

  <a id="SizedTypes.execStm"></a><a id="5434" href="slides4.html#5434" class="Function">execStm</a> <a id="5442" class="Symbol">:</a> <a id="5444" class="Symbol">∀</a> <a id="5446" class="Symbol">{</a><a id="5447" href="slides4.html#5447" class="Bound">Γ</a><a id="5448" class="Symbol">}</a> <a id="5450" class="Symbol">{</a><a id="5451" href="slides4.html#5451" class="Bound">i</a><a id="5452" class="Symbol">}</a> <a id="5454" class="Symbol">(</a><a id="5455" href="slides4.html#5455" class="Bound">s</a> <a id="5457" class="Symbol">:</a> <a id="5459" href="slides4.html#5224" class="Postulate">Stm</a> <a id="5463" href="slides4.html#5447" class="Bound">Γ</a><a id="5464" class="Symbol">)</a> <a id="5466" class="Symbol">→</a> <a id="5468" href="slides4.html#5304" class="Record">Exec</a> <a id="5473" class="Symbol">{</a><a id="5474" href="slides4.html#5447" class="Bound">Γ</a><a id="5475" class="Symbol">}</a> <a id="5477" href="slides4.html#5451" class="Bound">i</a> <a id="5479" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="5483" href="slides4.html#5434" class="Function">execStm</a> <a id="5491" class="Symbol">=</a> <a id="5493" href="slides4.html#5188" class="Postulate">⋯</a>

  <a id="SizedTypes.execPrg"></a><a id="5498" href="slides4.html#5498" class="Function">execPrg</a> <a id="5506" class="Symbol">:</a> <a id="5508" class="Symbol">∀</a> <a id="5510" class="Symbol">{</a><a id="5511" href="slides4.html#5511" class="Bound">i</a><a id="5512" class="Symbol">}</a> <a id="5514" class="Symbol">(</a><a id="5515" href="slides4.html#5515" class="Bound">prg</a> <a id="5519" class="Symbol">:</a> <a id="5521" href="slides4.html#5264" class="Postulate">Program</a><a id="5528" class="Symbol">)</a> <a id="5530" class="Symbol">→</a> <a id="5532" href="slides4.html#4500" class="Record">Delay</a> <a id="5538" href="slides4.html#5511" class="Bound">i</a> <a id="5540" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
  <a id="5544" href="slides4.html#5498" class="Function">execPrg</a> <a id="5552" href="slides4.html#5552" class="Bound">prg</a> <a id="5556" class="Symbol">=</a> <a id="5558" href="slides4.html#5188" class="Postulate">⋯</a>
</pre>
<p>See <a href="https://jespercockx.github.io/ohrid19-agda/src/V3/html/V3.Interpreter.html">V3/Interpreter.agda</a> for full code.</p>
</section><section id="exercise" class="slide level2">
<h2>Exercise</h2>
<p>Now you should be ready to add a bigger new feature:</p>
<ul>
<li>A new control operator: <code>if</code> statements, <code>do/while</code> loops, <code>for</code>, <code>switch</code>, …</li>
<li>New types: <code>char</code>, <code>bool</code>, …</li>
<li>New programming concepts: function calls, pointers (hard!), …</li>
</ul>
<p>Extend the syntax, the typechecker, and the interpreter with rules for your new feature.</p>
</section></section>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//lib/js/head.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: false,
        // Transition style
        transition: 'linear', // none/fade/slide/convex/concave/zoom
        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,
        height: 720,
        // Factor of the display size that should remain empty around the content
        margin: 0.2,
        math: {
          mathjax: '/usr/share/javascript/mathjax/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // Optional reveal.js plugins
        dependencies: [
          { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//plugin/zoom-js/zoom.js', async: true },
          { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//plugin/math/math.js', async: true },
          { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0//plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
